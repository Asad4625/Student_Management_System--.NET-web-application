@model SMSProject.Models.CourseM

@{ Layout = null;
    ViewBag.Title = "Student Dashboard";
}
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="~/Content/Site.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />

</head>
<header class="main-header">
    <div class="container">
        <div class="logo">
            <img src="https://img.icons8.com/ios-filled/40/000000/graduation-cap.png" alt="Logo" style="height:32px; width:32px;" />
            <span>University Admin Portal</span>
        </div>

        <div class="profile-menu">
            <div class="profile-icon" id="profileIcon">
                <img src="@ViewBag.StudentPhoto" alt="Profile" />
            </div>
            <div class="profile-dropdown" id="profileDropdown">
                <center><a>Profile</a></center>

                <div class="text-center mb-2" >
                    <div style="text-align:center;">
                        <img src="@ViewBag.StudentPhoto" alt="Profile" style="width:120px; height:120px; border-radius:50%; object-fit:cover;" />
                    </div>
                    <p><strong>Your ID:</strong> @ViewBag.AdminCNIC</p>
                    <p><strong>Your City:</strong>@Model.Student.City</p>
                </div>



                <a href="@Url.Action("Index", "Home")" onclick="clearSession()" style="color:red;background-color:cornsilk">Logout</a>


            </div>
        </div>
    </div>
</header>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const profileIcon = document.getElementById("profileIcon");
        const profileDropdown = document.getElementById("profileDropdown");

        profileIcon.addEventListener("click", function (e) {
            e.stopPropagation(); // Prevent click from closing the dropdown immediately
            profileDropdown.classList.toggle("show");
        });

        document.addEventListener("click", function () {
            profileDropdown.classList.remove("show");
        });
    });
</script>

<div class="dashboard-container">
    <div class="dashboard-header">
        <h1>Student Dashboard</h1>
        <p>Welcome back, @Model.Student.Name!</p>
    </div>

    <div class="profile-section">
        <div class="profile-card">
            <h2>Profile Information</h2>
            <div class="profile-details">
                <div class="detail-row" style="margin-left: 30px; border-radius: 50%; text-align: center;">
                    <img src="@ViewBag.StudentPhoto" alt="Profile" style="width:120px; height:120px; border-radius:50%; object-fit:cover;" />

                </div>
                <div class="detail-row">
                    <label>Student ID</label>
                    <p>@Model.Student.StudentID</p>
                </div>
                <div class="detail-row">
                    <label>Full Name</label>
                    <p>@Model.Student.Name</p>
                </div>
                <div class="detail-row">
                    <label>CNIC</label>
                    <p>@Model.Student.CNIC</p>
                </div>
                <div class="detail-row">
                    <label>Gender</label>
                    <p>@Model.Student.Gender</p>
                </div>
                <div class="detail-row">
                    <label>Email</label>
                    <p>@Model.Student.Email</p>
                </div>
                <div class="detail-row">
                    <label>Phone</label>
                    <p>@Model.Student.Phone</p>
                </div>
                <div class="detail-row">
                    <label>Department</label>
                    @foreach (var group in Model.AcademicHistory.GroupBy(x => x.Department))
                    {
                        <p>@group.Key</p>
                    }
                </div>
            </div>
        </div>

        <div class="progress-card">
            <h2>Academic Progress</h2>
            <div class="progress-stats">
                <div class="progress-circle">
                    <div class="progress-value">@Model.CompletionRate%</div>
                    <p>Completion Rate</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value completed">@Model.CompletedCourses</span>
                        <span class="stat-label">Completed</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value enrolled">@Model.EnrolledCourses</span>
                        <span class="stat-label">Enrolled</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value failed">@Model.FailedCourses</span>
                        <span class="stat-label">Failed</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="courses-section">
        <h2>Current Semester Courses</h2>
        <div class="courses-grid">
            @foreach (var course in Model.CurrentSemesterCourses)
            {
                <div class="course-card">
                    <h3>@course.CourseName</h3>
                    <p class="course-code">@course.CourseCode</p>
                    <p class="credit-hours">@course.Credits Credit Hours</p>
                    <span class="status enrolled">Enrolled</span>
                </div>
            }
        </div>
    </div>

    <div class="history-section">
        <h2>Academic History</h2>
        @foreach (var semester in Model.AcademicHistory.GroupBy(x => x.Semester))
        {
            <div class="semester-block">
                <h3>Semester @semester.Key</h3>
                <div class="course-list">
                    @foreach (var course in semester)
                    {
                        <div class="course-item">
                            <span class="course-code">@course.CourseID</span>
                            <span class="course-name">@course.CoursesName</span>
                            <span class="status @course.Status.ToLower()">@course.Status</span>
                        </div>
                    }
                </div>
            </div>
        }
    </div>
</div>
<style>

    /* HEADER */
    .main-header {
        background-color: #fff;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        height: 40px;
        position: fixed;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        top: 0;
        left: 0;
        width: 100%;
        justify-content: space-between;
        border-bottom: 1px solid #000;
        z-index: 100;
    }

        .main-header .container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

    .logo {
        display: flex;
        align-items: center;
        gap: 10px;
    }

        .logo img {
            height: 32px;
        }

        .logo span {
            font-weight: bold;
            font-size: 16px;
        }



    /* PROFILE MENU */

    .profile-menu {
        position: relative; /* Needed for absolute dropdown positioning */
        width: 25px;
        height: 25px;
        border-radius: 50%;
        margin-right: 70px;
        cursor: pointer;
        display: inline-block;
    }

    .profile-dropdown {
        display: none;
        position: absolute;
        right: 0; /* Show on left side */
        top: 40px; /* Show below */
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        min-width: 150px;
        z-index: 1000;
        flex-direction: column;
        overflow: hidden;
    }

        .profile-dropdown.show {
            display: flex;
        }

    .profile-icon img {
        height: 22px;
        width: 22px;
        border-radius: 50%;
        cursor: pointer;
        border: 2px solid #ddd;
        object-fit: cover;
        display: block;
    }



    .profile-dropdown a {
        padding: 10px 15px;
        text-decoration: none;
        color: #333;
        display: block;
        nav-down: current;
        transition: background 0.2s;
    }

        .profile-dropdown a:hover {
            background: #f5f5f5;
        }




    .dashboard-container {
        max-width: 1200px;
        margin: 60px auto 20px;
        padding: 20px;
    }

    .dashboard-header {
        margin-bottom: 30px;
    }

    .profile-section {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
    }

    .profile-card, .progress-card {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .detail-row {
        display: grid;
        grid-template-columns: 150px 1fr;
        padding: 8px 0;
        border-bottom: 1px solid #eee;
    }

    .progress-stats {
        text-align: center;
    }

    .progress-circle {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: #e9ecef;
        margin: 20px auto;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-top: 20px;
    }

    .courses-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .course-card {
        background: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .status {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
    }

    .enrolled {
        background: #cce5ff;
        color: #004085;
    }

    .completed {
        background: #d4edda;
        color: #155724;
    }

    .failed {
        background: #f8d7da;
        color: #721c24;
    }
</style>